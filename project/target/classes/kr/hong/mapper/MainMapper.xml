<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.hong.mapper.MainMapper">
	
	<insert id="join" parameterType="kr.hong.domain.User">
    	insert into tbl_user(user_id, user_pw, user_name, user_birthdate, user_nationality, user_joindate, admin_yn, user_status) 
      	values (#{user_id}, #{user_pw}, #{user_name}, now(), #{user_nationality}, now(), 'n', 'n')
	</insert>
	<select id="login" parameterType="kr.hong.domain.User" resultType="kr.hong.domain.User">
	    select * from tbl_user where user_id = #{login_user_id} and user_pw = #{login_user_pw}
	</select>
	
	<select id="WordList1" resultType="kr.hong.domain.Word">
	    select * from tbl_word where level = 1 order by study_date asc
	</select>
	
	<!-- 신규 -->
	<select id="SylList" resultType="kr.hong.domain.Syllable">
	    select * from tbl_syllable order by study_date asc
	</select>
		<select id="WordList" resultType="kr.hong.domain.Word">
	    select * from tbl_word order by study_date asc
	</select>
		<select id="SenList" resultType="kr.hong.domain.Sentence">
	    select * from tbl_sentence order by study_date asc
	</select>
		<select id="studypage2_sy" parameterType="String" resultType="kr.hong.domain.Syllable">
	    select * from tbl_syllable where study_date = #{day}
	</select>
		<select id="studypage2_wo" parameterType="String" resultType="kr.hong.domain.Word">
	    select * from tbl_word where study_date = #{day}
	</select>
		<select id="studypage2_sen" parameterType="String" resultType="kr.hong.domain.Sentence">
	    select * from tbl_sentence where study_date = #{day}
	</select>
	<select id="mypage1_sy" parameterType="kr.hong.domain.User" resultType="kr.hong.domain.Mypage">
	    SELECT s.study_date, AVG(t.accuracy) 
	    FROM tbl_syllable AS s
		JOIN tbl_syllable_test AS t
		ON t.num = s.num
		WHERE t.user_id = #{user_id}
		group by s.study_date
		having COUNT(*)=5
		order by s.study_date;
	</select>
	<select id="mypage1_wo" parameterType="kr.hong.domain.User" resultType="kr.hong.domain.Mypage">
	    SELECT s.study_date, AVG(t.accuracy) 
	    FROM tbl_word AS w
		JOIN tbl_word_test AS t
		ON t.num = s.num
		WHERE t.user_id = #{user_id}
		group by s.study_date
		having COUNT(*)=5
		order by s.study_date;
	</select>
	<select id="mypage1_se" parameterType="kr.hong.domain.User" resultType="kr.hong.domain.Mypage">
	    SELECT s.study_date, AVG(t.accuracy) 
	    FROM tbl_sentence AS s
		JOIN tbl_sentence_test AS t
		ON t.num = s.num
		WHERE t.user_id = #{user_id}
		group by s.study_date
		having COUNT(*)=5
		order by s.study_date;
	</select>
	
	
</mapper> 